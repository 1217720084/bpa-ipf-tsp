UTILITY:    FINDOUT - common CFLOW architecture
TYPE:       Powerflow (BPF) output report post-processor.
SUMMARY:    Generates a table of outages and corresponding branch overloads or
            bus voltage violations from multiple pfo files. Sorts and screens.
RELATED:    LINEFLOW, MIMIC, CFUSE
SEE ALSO:   TO_DECWRITE.HELP, VMS_TO_PC_TO_EXCEL.HELP 
UPDATED:    August 22, 1996 
LANGUAGE:   Standard C.  CFLOW Library.  cf_util.h 
DEVELOPER:  William D. Rogers, BPA, TEOS (detail), 230-3806, wdrogers@bpa.gov
REQUESTER:  IPF User Group (L. Stadler, P. Larguier, K. Kohne) 
USERS:      Kyle Kohne, Larry Stadler, Dorothy Betzing, Jeff Mechenbier
IPF:        version 316 or above recommended.
PURPOSE:    Works with the .pfo output files of /OUTAGE_SIMULATION runs as a 
            post-processor to screen and sort the results and present them in 
            tabular form.  Tables of 'Outages and Overloads' or 'Outages and 
            Bus Violations' can be produced.  Entries in these tables can be
            screened according to Zone, Owner, Base kV, Loading and Bus Voltage.
            Tables can be sorted by Zone, Owner, Base kV, or alphabetically. The
            idea is to allow the user to automate the creation of a report 
            detailing the results of outages--saving time and reducing errors 
            from the current method of doing so which generally includes cut and
            paste operation with an editor.

            Data fields in the output report table are character delimited to 
            ease importing to MS Excel or DECwrite.

INPUT REQUIREMENTS:
    Powerflow output report (*.pfo) files generated by /OUTAGE_SIMULATION.
    Optionally, text files containing data for FINDOUT to work with.

PROMPTS:
    /PFO or /INCLUDE
     > Enter list of .PFO files (and/or data files):

    /REPORT
     > Enter report name,      NAME = [FINDOUT.RPT]:

     Specify the type of output report (by number)
       1. OUTAGEs  causing  OVERLOADs    2. OUTAGEs  causing  BUS Violations
       3. OVERLOADs caused by OUTAGEs    4. BUS Violations caused by OUTAGES
     > Enter report choice, TYPE =[OUTAGE-OVERLOAD]:
     > Redundant outages:   REMOVE_REDUNDANT = [NO]:
     > Do a difference report?     DO_DELTA = [YES]:

     Specify sort priority (by number)
       1. ALPHA-base_kv   3. OWNER-alpha-base_kv    5. INPUT order
       2. BASE_KV-alpha   4.  ZONE-alpha-base_kv    6. SOLUTION
     > Enter sort choice,            SORT = [ALPHA]:

     Specify output report format (by number)
       1. DATA-FULL (Excel) 2. DATA-BRIEF (Excel) 3. PAGE-WIDE 4. PAGE-COMPACT
     > Enter format choice,    FORMAT = [DATA-FULL]:

     Specify the maximum number of cases per table (6 fit in 132 columns).
     > Enter width,   CASES_PER_TABLE = [3]:

    /INCLUDE
     > Enter list of files with branch or bus lists:

    /OUTAGE
     > Enter outaged branches list       :
       > Tycown< BUS1 ><V1> < BUS2 ><V2>cs
       >
    /COMMON_MODE
     > Enter common-mode outages list    :
       >

    /OUTG_OWNER, /OUTG_ZONE, /OUTG_BASE_KV
     Specify selection of branch OUTAGEs and COMMON_MODE outages
     > Enter owners of interest..[all owners='***']:
     > Enter zones of interest.....[all zones='**']:
     > Enter base_kv of interest.[all base kV='>0']:

    /OVERLOAD
     > Enter overloaded branches list    :
       > Tycown< BUS1 ><V1> < BUS2 ><V2>cs
       >

    /PROB_OWNER, /PROB_ZONE, /PROB_BASE_KV
     Specify selection of OVERLOADed branches
     > Enter owners of interest..[all owners='***']:
     > Enter zones of interest.....[all zones='**']:
     > Enter base_kv of interest.[all base kV='>0']:

    /LIMITS
     > Enter max change in %, MAX_DELTA_PCT = [ 0%]:
     > Enter max loading in %, MAX_LOAD_PCT = [80%]:

     > Include solution problems? INC_SOLN_PROB=[Y]:

     Trace  report written to FINDOUT.TRC
     > Do you want to continue this run?        [Y]:

OUTPUT FILES:
    *.rpt - Report file with a formatted table of values.
    *.trc - Trace file containing a script of the session that can be repeated.
    *.log - Log/error file containing error messages, if any.
    Stdout messages.

INPUT AND TRACE DATA FORMATS:
    Forward-slash / tags alert the program to the type of data to follow.  Data
    should follow on subsequent lines, but not on the line with the / card.
    / tags and data are recorded in a trace (.TRC) file after all prompts have
    been answered.  The trace file is a record of input and can be user-modified
    and input into the program on subsequent runs.

    All characters after a \ (back slash) are ignored.
    A line with a . in column one is ignored.

    /INCLUDE 
        when this tag occurs in a trace file, a list of text file names will be
        read from the following lines.  Each file will be opened and scanned for
        other / cards containing basecase, branch, or script data.  The data 
        files (usually .DAT or .LIS) can also be specified at the /PFO or 
        /INCLUDE prompts when running interactively.

    /PFO
        a list of Powerflow analysis files (*.PFO). Multiple files may occur on 
        each line.  To include a text file containing a list of pfo files, 
        specify it after a /INCLUDE card.  The needed .PFO files are generated
        by using IPF's fast outage capability through the /OUTAGE_SIMULATION
        command.

        The following "Summaries" are searched for in the *.PFO files.
            Summary of bus and line problems for each outage
            Summary of System Separations and Divergences
            Summary of Common Mode Outages


        note: at the "/PFO or /INCLUDE" prompt, *.pfo and include (data) files
        may both be specified in a list form.  For example:

        /PFO or /INCLUDE
         > Enter list of .PFO files (and/or data files): J.PFO, A.PFO, DIFF.TRC

            where, J.PFO and A.PFO could be winter and summer cases and DIFF.TRC
            could be a trace file requesting a list of branches loaded above 85%
            and with overloads differing by 5% or more, belonging to BPA, in
            zone NB, at 230kV, and formatted for export to Excel and sorted by
            percent over-loading.

    /OUTAGE, /COMMON_MODE, /OVERLOAD, /BUS
        Branch and bus data is specified in Powerflow card format.  Specify one
        branch or bus per line.  Only the key id items are required: T, L or
        B for type, bus name(s) and kv(s).  If section or circuit id are blank,
        they are treated as wild cards and all branches between the specified
        buses will be found.  Note, this works much faster than using ?? for the
        circuit and section.

	Note: all branches will be sorted low alpha to high alpha and high kv to
        to low kv in order to conform to the fastoutage data in the PFO file.

        For wildcard searches, place at least one question mark, ?, in the data
        and all non-blank characters will be matched.  For example:

        > Tycown< BUS1 ><V1> < BUS2 ><V2>cs (Lowercase fields optional)
        > ?  B??MON?????

        will match any branch (transformer or line) whose owner starts with 'B'
        and has a bus starting with 'MON'.  Note:  This function can be very
        slow and base kv, if specified, must be in the form: [500.] instead of
        [ 500] in its 4 digit field.  Leave ckt and section blank if wild card
        search is desired.

    /OUTG_OWNER, /OUTG_ZONE, /OUTG_BASE_KV - outage and common_mode outages
    /PROB_OWNER, /PROB_ZONE, /PROB_BASE_KV - overloaded branches, u/o voltages
        Enter a list of owner, zones, or base kv after each appropriate tag.
        The wildcard * may be used in owner or zone names.  For example,
            N* as a zone matches NA, NB, NC,...,NZ.
        The bang ! symbol is used to exclude zones or owners.  For example,
            !NA, !NB  will retrieve data on all zones except NA and NB.
        To specify ALL ZONES or ALL OWNERS (these are the defaults) use ** and
            ***, respectively.
        Base kv is specified explicitly or by range.  For example,
            69, 115, >230, <69, 115-500, are all valid.  >115 gets all base kv
            strictly greater than 115 kV, not including 115.  115-230 gets all
            base kV between 115 and 230 kV including 115 and 230 kV.  Use >0 to
            specify ALL BASE KV; this is the default.

    /LIMIT
        This tag has up to seven valid data items:
         MAX_DELTA_PCT = 5  (any valid percentage)
         MAX_LOAD_PCT = 80  (any valid percentage)
         MAX_500_PU = 1.100 (for 500 kV busses)
         MIN_500_PU = 1.000
         MAX_BUS_PU = 1.052 (for busses with kV less than 500 kV)
         MIN_BUS_PU = 0.950
         INC_SOLN_PROB = YES

    note: for a difference report, both the MAX_DELTA_PCT and MAX_LOAD_PCT
          must be satisfied or the MAX_DELTA_PCT and voltage limits, depending
          on the type of report requested.

    /REPORT
        This tag contains all other program control data.
            NAME = LINEFLOWX.RPT       (specifies the name of the report)
            TYPE = OUTAGE-OVERLOAD     (or, OVERLOAD-OUTAGE, OUTAGE-BUS_V,
                                         BUS_V-OUTAGE)
            SORT = SOLUTION            (or, ALPHA, BASE_KV, ZONE, OWNER, INPUT)
            FORMAT = DATA_FULL         (or, DATA_BRIEF, PAGE_WIDE, PAGE_COMPACT)
            REMOVE_REDUNDANT = NO      (or, YES; used with common-mode outages)
            TRACE = ON                 (or, OFF, stops generation of trace)
            DELTA = ON                 (or, OFF; differences between PFO files)
            CASES_PER_TABLE = 6        (width depends upon FORMAT and TYPE)

        A note on the REMOVE_REDUNDANT option:
            A value of 'NO' causes FINDOUT to report all outages not filtered
            out by other means, such as owner, zone, etc.  This is the default.

            A value of 'YES' causes FINDOUT to not report problems caused by 
            outages that have previously been taken as part of a common-mode
            outage.  This is an additional screening tool.  For example, if
            a bus delete common-mode outage resulted in a branch outage, that
            branch would be taken out a second time by itself by the IPF 
            Fastoutage facility.  This option allow the user to automatically
            screen out the problems caused by the second occurance of that
            branch outage.

OUTPUT REPORT FORMAT:
    Data delimiter - a vertical bar '|' character is inserted between each data
        field in the output report.  The vertical bar is used as a delimiter so
        that the tables can be imported into Microsoft Excel of DECwrite. 
    
    A table of values is generated.  For each branch, the critical-rating is
    given and for each case, each branch's load and percent of rating is given.
    Critical ratings are based on the first case that is read.  Flags are placed
    in the output report in the |F| columns to indicate the rating type of 
    subsequent cases.

The table is then printed to a text file. For example (FORMAT = PAGE_COMPACT):
--------------------------------------------------------------------------------
.  |   |OUTAGES CAUSING OVERLOADS| | |  |  |    | |     A.PFO|||
.  |   | Outage followed by...   | | |  |  |    | |[        ]|||
.  |   |    ...List of Overloads | | |  |  |CRTC| | LOAD |LOAD||
.Yc|OWN|< BUS1 ><V1> < BUS2 ><V2>|C|S|Z1|Z2|RATG|F|ACTUAL|(%)|F|
  
L  |BPA|ABERD TP115. COSMOPLS115.| | |NA|NA|                        <-- outage
L  |GH |ABERDEEN115. WEYERHSR115.| |0|NA|NA| 478|T| 395.8| 83|T|    <-- overload

L  |BPA|ACTON   115. BONNVILE115.| | |NB|NB|                        <-- outage
L  |PPL|HOOD RVR69.0 POWERDLE69.0| |0|NB|NB| 300|N| 287.2| 96|N|    <-- overload
L  |PPL|POWERDLE69.0 SDS TAP 69.0| |0|NB|NB| 310|N| 460.6|149|N|    <-- overload
--------------------------------------------------------------------------------

USAGE:

Set up a symbol to point to the program executable (add to your login file):
$ DEFINE    CFPROGS    BPA8::DISK24:[PSAP.IPF.CFPROGS]          (BPA40,50,60,70)
$ DEFINE    CFPROGS    DISK9:[PSAP.IPF.CFPROGS]                 (MOEA Cluster)
$ @CFPROGS:CFLOW_SYM_DEF.COM

This sets up one or the other of the following two symbols:
> SHO SYM FINDOUT
  FINDOUT == "$CFPROGS:FINDOUT.ALF_EXE"   (if you're on an Alpha VMS machine)
  FINDOUT == "$CFPROGS:FINDOUT.EXE"       (if you're on a VAX VMS machine)

Run CFLOW program by typing its symbol.
> FINDOUT (optionally follow with a list of *.pfo, trace, or list files)

Follow the prompts.  Just press return to use the default values which are given
in brackets [].

The following two symbols must be defined similar to what follows:
> SHOW SYMBOL RUN_IPFSRV_CF
  RUN_IPFSRV_CF == "@BPA8::DISK24:[PSAP.IPF]RUN_IPFSRV_CF.COM"
> SHOW SYMBOL IPFSRV_CF
  IPFSRV_CF == "$BPA8:DISK24:[PSAP.IPF]GPF.EXE_V209"

LOCATION: (Look here for the most recent updates.)
    BPA8::DISK24:[PSAP.IPF.CFPROGS]FINDOUT.EXE      - The VAX executable
    BPA8::DISK24:[PSAP.IPF.CFPROGS]FINDOUT.ALF_EXE  - The ALPHA executable
    BPA8::DISK24:[PSAP.IPF.CFPROGS]FINDOUT.C        - The C source code
    BPA8::DISK24:[PSAP.IPF.CFDOC]FINDOUT.HELP       - Text help file


bpa8::disk24:[psap.ipf.cfdoc]findout.help
