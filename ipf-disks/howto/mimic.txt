UTILITY:    MIMIC
STRUCTURE:  common CFLOW architecture.
TYPE:       Powerflow (IPFSRV) case generation and screening.
SUMMARY:    Generate new cases and check for loading and voltage violations.
RELATED:    LINEFLOW, FINDOUT
SEE ALSO:   MODES.TXT
UPDATED:    July 31, 1996
LANGUAGE:   Standard C.  CFLOW Libraries.  CF_UTIL.H.
DEVELOPER:  William D. Rogers, BPA, TEOS (detail), 230-3806
REQUESTER:  Gordon Young, BPA, TEOB, 230-4430
USERS:      Gordon Young, Paul Ferron, Berhanu Tesema, Angela DeClerck,...
IPF:        IPFSRV version 317 or above recommended
PURPOSE:    Automates solving and screening basecases, applying changes to
            basecases, basecase comparisons, and plot generation.

INPUT REQUIREMENTS: (some or all of the following depending on user selections.)
    Powerflow basecases for IPFSRV to load, change, solve and return data from.
    Change files to apply to base cases.
    Text files containing a list of base case file names.
    Text files containing a list of change file names.
    Trace file specifying all or some of the desired inputs.
    Coordinate files for plot generation.
    Outage simulation (fastoutage) control file.

MODES OF OPERATION:
    MIMIC uses built in intelligence to prompt the user based on the information
    already provided.  This serves to reduce the number of queries the user
    must answer to run the program.

    MIMIC automates these operations:
        1)  Applying multiple changes to multiple base cases
        2)  Solving and screening multiple base cases
        3)  Comparing two or more base cases
        4)  Generating plots (including difference plots)
        5)  Building Excel-ready report tables
        6)  Logging all user input into a "TRACE" file
        7)  Performing multiple similar studies
        8)  Re-running studies with updated base cases
        9)  Automating /Outage_simulation studies
       10)  Solving basecases with /SOLUTION options

    MIMIC screens data using these filters:
        1)  Line and transformer loading
            a.  maximum allowable loading
            b.  changes in loading
            c.  changes in loading above a threshold
        2)  Bus voltage
            a.  separate limits for 500 kV buses and sub-500 kV buses
            b.  maximum and minimum voltage
            c.  heavy winter conditions
            d.  changes in voltage
            e.  changes in voltage above a threshold
        3)  Owner    (include, exclude, all, and/or wildcard; NA, !PR, A*, !T*)
        4)  Zone     (include, exclude, all, and/or wildcard; NA, !PR, A*, !T*)
        5)  Base kV  (list and/or ranges; 230, >350, <35, 69-115)

    MIMIC reports these quantities:
        1)  Branch loadings
        2)  Bus voltages
        3)  Transformer tap settings
        4)  Difference in value between two base cases
        5)  /OUTAGE_SIMULATION reports go to their own file

    MIMIC generates these reports:
        1)  Summary of Voltage Violations
        2)  Summary of Voltage Violations and Voltage Changes
        3)  Summary of Overloaded  Transformers
        4)  Summary of Overloaded Transformers and Loading Changes
        5)  Summary of Overloaded Lines
        6)  Summary of Overloaded Lines and Loading Changes
        7)  Summary of Tap Positions
        8)  Summary of Tap Positions and Tap Changes

PROMPTS:
    /BASECASE, /TRACE, or /INCLUDE
     > Enter list of Basecases (and/or data files) :

    /PRI_CHANGE
     > Enter list of Primary-Change(or data files) :

    /AUX_CHANGE
     > Enter list of Auxillary-Chng(or data files) :

    /NEW_BASE
     > Enter list of New Base names(or data files) :

    /REF_BASE
     > Enter list of Ref base cases(or data files) :

    /COORDINATE
     > Enter list of Coordinate files or data files:

    /REPORT
     > Enter report name,        NAME = [MIMIC.RPT]:

     Plot Options: P -print plot file. S -save plot file. D -difference plots.
     > Enter P, S, and/or D,      PLOT = [PS]:

     Enter a list of the types of checks that you want performed:
       0.  No checks - just apply changes - NONE.
       1.  Check Bus Voltages             - CHECK_VOLTAGE.
       2.  Check Branch Loading           - CHECK_LOADING.
       3.  Check Transformer Tap Settings - CHECK_TAPS.
       4.  Check and Compare Bus Voltages to Reference   - COMPARE_VOLTAGE.
       5.  Check and Compare Branch Loading to Reference - COMPARE_LOADING.
       6.  Check Transformer Tap Changes from Reference  - COMPARE_TAPS.
       7.  Perform Outage Simulation (fast outage) - OUTAGE_SIMULATION.
     > Enter check list, CHECK = : 1, 2  3 4

    /LIMITS
     Check Voltage: Enter limits:
     > Max 500kV-bus voltage PU, MAX_500_PU=[1.100]:
     > Min 500kV-bus voltage PU, MIN_500_PU=[1.000]:
     > Max sub-500kV voltage PU, MAX_BUS_PU=[1.052]:
     > Min sub-500kV voltage PU, MIN_BUS_PU=[0.950]:
     > Min EH Winter, 500kV-bus, MIN_EH5_PU=[1.050]:
     > Min EH Winter, sub-500kV, MIN_EHV_PU=[1.000]:

     Check Delta Voltage: Enter limits:
     > Max 500kV-bus voltage PU, DV_MAX_500_PU=[1.100]:
     > Min 500kV-bus voltage PU, DV_MIN_500_PU=[1.000]:
     > Max sub-500kV voltage PU, DV_MAX_BUS_PU=[1.052]:
     > Min sub-500kV voltage PU, DV_MIN_BUS_PU=[0.950]:
     > Min EH Winter, 500kV-bus, DV_MIN_EH5_PU=[1.050]:
     > Min EH Winter, sub-500kV, DV_MIN_EHV_PU=[1.000]:
     > Max voltage change, pct,  DV_MAX_DELTA =[  1.0]:

     Check Loading: Enter loading limits for solution check:
     > Maximum loading   (% Rating), MAX_LOAD_PCT=[100.0]:

     Perform /OUTAGE_SIMULATION: Enter control file:
     > Outage sim. control file,   OUTG_CON_FILE = :

    /OWNER, /ZONE, /BASE_KV
     > Enter owners of interest..[all owners='***']:
     > Enter zones of interest.....[all zones='**']:
     > Enter base_kv of interest.[all base kV='>0']:

    /REPORT
     > SAVE_NEW_BASECASES with changes? [Y]:
     > SHOW_CHANGES files in report?    [Y]:

    /COMMENT
     > Enter an 80-character comment string:

OUTPUT FILES:
    Report File - text file containing table of reported values.
    Trace File - text file containing list of all input values.
    Stdout messages.
    Text file containing output from Powerflow (IPFSRV) called ipfsrv_cf.out.
    MIMIC.LOG
    *.pfo files generated with /OUTAGE_SIMULATION analysis.

INPUT FILE FORMATS:

    trace file - this file contains a 'trace' of all inputs to MIMIC on a
        previous run.  It can be edited and modified.  Information deleted from
        a trace file will be prompted for on the next run.  Thus, a trace file
        can be set up to contain a list of 'default' inputs.  To control the way
        cases solve, add (all solution options can be used):
            /SOLUTION
            > solution option
            > solution option
            > etc. until done.

    'base case/list' -
        basecase - a single basecase name.  MIMIC searches the local directory
            and then the various basecase directories to find it.

        basecase list - a text file containing a list of Powerflow cases with
            one file specification per line.  The file name should end in .DAT.

For example:
BASE.DAT
--------------------------------------------------------------------------------
! The symbol '!' in column 1 indicates a comment line and is ignored.
! List the names of the powerflow cases one per line.
!
J98CY94.BSE
J98MCY94.BSE
--------------------------------------------------------------------------------

    'pri chngs/list' -
        pri chngs - Primary Changes file.  Contains change records to be applied
            to the base case(s).
        pri chngs list - Primary Changes List file.   A text file containing a
            list of change files.

    'aux chngs/list' -
        aux chngs - Auxillary Changes file.  Contains change records to be
            applied to the base case(s).
        aux chngs list - Auxillary Changes List file.   A text file containing a
            list of change files.

For example:
J98_OPTION_A.CHG - a change file.
--------------------------------------------------------------------------------
/CHANGES,FILE= *\
. REMOVAL OF THE COL FALL 230/115-kV TRANSFORMER FROM BASE	
. SIMULATED LOSS OF 230/115-KV INTERCONNECTION
T D   COL FALL 230 COL FALL 115
(END)
--------------------------------------------------------------------------------

For example:
CHANGE.DAT - a list of primary changes
--------------------------------------------------------------------------------
! The symbol '!' in column 1 indicates a comment line and is ignored.
! List the names of the change files one per line.
!
J98_OPTION_A.CHG
J98_OPTION_B.CHG
--------------------------------------------------------------------------------

    'ref base /list' -
        ref base - a Reference Basecase name. MIMIC searches the local directory
            and then the various basecase directories to find it.

        ref base list - a text file containing a list of Powerflow cases with
            one file specification per line.  The file name should end in .DAT.

    'cor file /list' -
        cor file - a Coordinate File used for generating plots.   MIMIC searches
            the local directory and then the various basecase directories.

        cor file list - a text file containing a list of Coordinate files with
            one file specification per line.  The file name should end in .DAT.

     Outage simulation control file (OUTG_CON_FILE) - a text file containing
        commands for /OUTAGE_SIMULATION studies.  MIMIC will send a command
        structured as follows:
        /OUTAGE_SIMULATION, FILE = <OUTG_CON_FILE>, OUTFILE = <basecase>.PFO    

OUTPUT REPORT FORMAT:

    'output report' name - any valid file specification.  A default is provided.

    The data fields are delimited with vertical bars (|) to facilitate moving 
    the data into DECwrite and Excel.

Basic form of this report shown below to give the general idea.
********************************************************************************
/BASECASE      | FGROVE.BSE
/PRI_CHANGE    | FG.CHG
/AUX_CHANGE    | 
/NEW_BASECASE  | FGROVE_000.BSE
/REPORT        | NAME = MIMIC.RPT
/OWNER         | BPA
/ZONE          | **
/BASE_KV       | 115-230
/COMMENT       | 
/REPORT        | TRACE=ON, PLOT =NONE, SAVE_NEW_BASECASES=YES, SHOW_CHANGES=YES
/REPORT        | CHECK= CHECK_VOLTAGE
/LIMITS        | REPORT_0_RATINGS = NO   CHECK_TX_THERMAL = NO
   MAX_500_PU = 1.050,   MIN_500_PU = 1.000,   MIN_500_EH = 1.050
   MAX_BUS_PU = 1.020,   MIN_BUS_PU = 1.000,   MIN_BUS_EH = 1.000
********************************************************************************
Primary Change File: FG.CHG
--------------------------------------------------------------------------------
/CHANGES,FILE = * \
C DELETE CORNELUS 59.8 TO ORENCO 59.8 CIRCUIT 1
L DPG CORNELUS59.8 ORENCO  59.81
T DBPAKEELER   115 KEELER   2302
(END)
--------------------------------------------------------------------------------

   |   |FGROVE_000.B|
   |   |BUS VOLTAGES|  | Voltage|
TYc|OWN|< BUS  ><KV>|ZN| ( PU  )|
B  |BPA|BEAVER  115.|NB|   1.025|
B  |BPA|BRUSH CL115.|NB|   1.034|
BT |BPA|CARLTON 115.|NB|   1.028|
BT |BPA|CHEMAWA 115.|NB|   1.034|
BQ |BPA|CHEMAWA 230.|NB|   1.043|

  FGROVE.BSE + FG.CHG = FGROVE_000.BSE                                 PAGE    1
--------------------------------------------------------------------------------

    The TRACE FILE for the above report is give below.
--------------------------------------------------------------------------------
. MIMIC.TRC   02-May-1996 14:25:26 WDR9936 $DISK1:[PSAP.IPF]GPF.EXE_V315
/BASECASE
  FGROVE.BSE
/PRI_CHANGE
  FG.CHG
/AUX_CHANGE
/NEW_BASECASE
/REF_BASECASE
/COORDINATE
/PLOT_NAME
/OWNER
  BPA
/ZONE
  **
/BASE_KV
  115-230
/COMMENT
/REPORT
  NAME = MIMIC.RPT
  PLOT = NONE
  APPLY = 1
  CHECK = CHECK_VOLTAGE
  TRACE = ON
  SAVE_NEW_BASECASES = YES
  SHOW_CHANGES = YES
/LIMITS
  MAX_500_PU = 1.050
  MIN_500_PU = 1.000
  MAX_BUS_PU = 1.020
  MIN_BUS_PU = 1.000
  MIN_EH5_PU = 1.050
  MIN_EHV_PU = 1.000
./TRACE
. FGROVE.BSE + FG.CHG = FGROVE_000.BSE 
--------------------------------------------------------------------------------

USAGE:

Add one of the following symbols to your login.com to point to the executables:
$ DEFINE    CFPROGS    BPA9::DISK24:[PSAP.IPF.CFPROGS]          (BPA40,50,60,70)
$ DEFINE    CFPROGS    DISK9:[PSAP.IPF.CFPROGS]                 (MOEA4)
$ DEFINE    CFPROGS    DISK5:[PSAP.IPF.CFPROGS]                 (MOEA2)
$ DEFINE    CFPROGS    DKA0:[PSAP.IPF.CFPROGS]                  (ALFSPO-Spokane)
$ @CFPROGS:CFLOW_SYM_DEF.COM

This sets up one or the other of the following two symbols:
> SHO SYM MIMIC
  MIMIC == "$CFPROGS:MIMIC.ALF_EXE"   (if you're on an Alpha VMS machine)
  MIMIC == "$CFPROGS:MIMIC.EXE"       (if you're on a VAX VMS machine)

Run CFLOW program by typing its name.
> MIMIC (optionally follow with a list of *.pfo, trace, or list files)

To implement the plotting capability, set up the symbol MIMIC_PSQ to point to a
PostScript device (add to login file):
> MIMIC_PSQ :== PRINT/QUEUE=PS_EOFQMS

Follow the prompts.  Just press return to use the default values which are given
in brackets [].

LOCATION: (Look here for the most recent updates.)
    BPA9::DISK24:[PSAP.IPF.CFPROGS]MIMIC.EXE        - The VAX executable
    BPA9::DISK24:[PSAP.IPF.CFPROGS]MIMIC.ALF_EXE    - The ALPHA executable
    BPA9::DISK24:[PSAP.IPF.CFPROGS]MIMIC.C          - The C source code
    BPA9::DISK24:[PSAP.IPF.CFDOC]MIMIC.HELP         - Latest version of this file


BPA9::disk24:[psap.ipf.cfdoc]mimic.help
