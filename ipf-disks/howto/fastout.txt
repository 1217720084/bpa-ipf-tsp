UTILITY:    FASTOUT
TYPE:       Powerflow (IPFBAT) output report post-processor.
SUMMARY:    Generates a table of the loading of overloaded branches for a list 
            of outages with data from one or more pfo files.
RELATED:    LINEFLOW, FASTOUT0 - THE OLD FASTOUT PROGRAM
SEE ALSO:   TO_PC.HELP, TO_DECWRITE.HELP, TO_EXCEL.HELP
UPDATED:    April 24, 1995
LANGUAGE:   Standard C.  CFLOW Library.
DEVELOPER:  William D. Rogers, BPA, TEOS, 230-3806
REQUESTER:  Mark S. Bond
USERS:      Kyle Kohne
PURPOSE:    Generate a table of values showing the loading of various branches 
            under the condition of a specified outage for various cases.  For 
            each case, the "Summary of bus and line problems for each outage" 
            report in the corresponding *.pfo file is scanned for the loading, 
            percent of rating, and rating type for each branch-outage pair.  One
            input file contains a list of *.pfo file path names.  A second input
            file contains a list of outages and branch-outage pairs.  Where 
            branch-outage pair is specified, data is collected from each *.pfo
            file for that pair.  Where only an outage is specified, all of the
            overloaded branches for that outage are reported.  Data fields in 
            the output report table are character delimited to ease importing to
            MS Excel or DECwrite.

INPUT REQUIREMENTS:
    Powerflow (IPFBAT) output report (*.pfo) files.
    Text file containing a list of *.pfo file path names, 'pfo file list'.
    Text file containing overloaded and outaged branchs, 'outages  list'.
    Prompts user for file names and ouput options.  Defaults in brackets [].
        > Enter 'pfo file list' file spec [pfolist.dat]:
        > Enter 'outages  list' file spec [outages.dat]:
        > Enter 'output report' file spec [fastout.rpt]:
        > Enter 'output report' page width....... [132]:

OUTPUT FILES:
    Text file containing a table of reported values, 'output report'.
    Stdout messages.

INPUT FILE FORMATS:

    *.pfo files - Output reports generated by Powerflow (BPF) that contain the
        "Summary of bus and line problems for each outage" report.

    'pfo file list' - a text file containing a list of powerflow (BPF) output
        files (*.pfo) with one file specification per line.  The symbols !,*, or
        . in the first column indicate a comment line.  The default filename is
        pfolist.dat.

For example:
--------------------------------------------------------------------------------
! Any of the three symbols {!*.} in column 1 indicate a commment line.
. Names of powerflow output files listed one per line.
disk15:[cflow.reports]j01cy94rfo.pfo
j01cy93rfo.pfo
--------------------------------------------------------------------------------

    'outages  list' - a text file containing a list of either monitored-branch 
        and outaged-branch pairs or outaged branches.  If only a single branch
        name is listed on a line, it is taken as the name of an outage and all
        branches overloaded by that outage will be reported in the output file.
        If a pair of branches is listed on a single line, the first is taken to
        be an overload caused by the outage of the second listed branch.  The
        loading of that overloaded branch will be listed in the output file, but
        the other overloaded branches for that outage will not be reported
        unless specified explicitly.

        Branch names are listed in Powerflow netdata format.  An optional
        vertical bar '|' can separate the overloaded from outaged branches when
        listed together on a single line.  Spaces before and after the vertical
        bar are ignored.  Branch id starts with the first character in the type
        field.  Branch types L, E, T, and TP are allowed.  The symbols !, *, or
        . in the first column indicate a comment line.  The default file name is
        outages.dat. 

For example:
--------------------------------------------------------------------------------
. Any of the five symbols {!*.} in column 1 indicate a commment line
. This same file may be used by LINEFLOW in which case the Outaged Branch data
. is ignored.
.     Monitored Branches          |       Outaged Branches
.Y OWN[ BUS1 ](KV)M[ BUS2 ](KV)CS |TY    [ BUS1 ](KV) [ BUS2 ](KV)CS
L     BEAVER   115 TILLAMOK 115   |L     BEAVER   115 TILLAMOK 11500
L     MASS     115 UNION T  115 0  TP    BROAD ST 115 EASTPINE 115
.     Outaged Branches - all overloaded branches caused by these outages will be
.        included in the output report table
.Y    [ BUS1 ](KV) [ BUS2 ](KV)CS
L     BEAVER   115 TILLAMOK 11500
TP    BROAD ST 115 EASTPINE 115
--------------------------------------------------------------------------------

OUTPUT REPORT OPTIONS:

    'output report' name - any valid file specification.  The default is
        fastout.rpt.

    Page width - the width in columns of the 'output report'.  Data for three
        cases of delimited data fields fit in 132 columns and 1 in 96 which the
        program defaults to if fewer columns are specified.  A large page width
        can be specified to cause all of the cases be printed in one table.  If 
        more cases are included than will fit across the page, additional tables
        are generated, following consecutively.  The default is 132 columns.

OUTPUT REPORT FORMAT:
    Data delimiter - an vertical bar '|' character is inserted between each data
        field in the 'output report'.  The vertical bar is used as a delimiter
        so that the tables can be imported into Microsoft Excel of DECwrite. 


A table of values is generated.  For each overloaded-branch/outaged-branch pair,
the critical rating is given and for each case, each branch's load and percent
of rating is given.  Critical ratings are based on the first case that is read, 
which is assumed to be the base case.  Flags are placed in the output report in
the |F| columns to indicate the type of rating found in the *.pfo file.

The table is then printed to a text file.  For example (fictionalized data):

Data fields delimited with |.  Note: A full report of even one case requires 100
columns.  Shown here wrapped around.  Actual output is 132 columns wide.
--------------------------------------------------------------------------------

.  |   |       CASE NAME:        | | |   |   |                         | 
.  |   |                         | | |   |   |                         | 
.  |   |  MONITORED BRANCH       | | |   |   |  OUTAGED BRANCH         | 
.Yc|OWN|< BUS1 ><V1> < BUS2 ><V2>|C|S|TYc|OWN|< BUS1 ><V1> < BUS2 ><V2>|C
L* |BPA|BEVERLY  115-SNOHOMSH 115|2|0|L  |BPA|BEVERLY  115-SNOHOMSH 115|1
L* |BPA|BEVERLY  115-SNOHOMSH 115|1|0|L  |BPA|BEVERLY  115-SNOHOMSH 115|2
L* |PSP|BOTHELL  230-SAMMAMSH 230| |2|T  |BPA|CHIEF JO 230-CHIEF JO 500| 
L* |PSP|BEVERLY  115-N.BOTHEL 115|1|0|L  |BPA|ECHOLAKE 500-MAPLVLTP 500| 
L* |PSP|BOTHELL  230-SAMMAMSH 230| |2|L  |BPA|ECHOLAKE 500-MAPLVLTP 500| 

 |       | | H97188F_MOD ||| H97188F_MOD ||| A97188F     |||
 | CRITCL| | [          ]||| [          ]||| [          ]|||
 | RATING| |  LOAD | LOAD| |  LOAD | LOAD| |  LOAD | LOAD| |
 | (UNIT)|F| (UNIT)| ( %)|F| (UNIT)| ( %)|F| (UNIT)| ( %)|F|
 |    490|T|  980.0|  200|T|  980.0|  200|T|  517.8|  106|T|
 |    490|T|  980.0|  200|T|  980.0|  200|T|  515.3|  105|T|
 |    555|T|    0.0|    0|T|    0.0|    0|-|  649.5|  117|T|
 |    306|B|  417.4|  136|B|  417.4|  136|B|  417.4|  136|T|
 |    556|E|  688.0|  124|E|  688.0|  124|E|  688.0|  124|t|

.UNIT is Amps for lines and MVA for transformers.
.CRITCL RATING taken from the first non-zero case.

.F Rating flags indicate type of critical rating.
.Lowercase flag indicates rating differs from listed value.
.T Thermal, N Nominal, B Bottleneck, E Emergency (Loss of Life)
.@ Outage found, but branch is not overloaded for this case.
.- Outage not found for this case.
--------------------------------------------------------------------------------

USAGE:

Set up a symbol to point to the program executable (add to login file):
> FASTOUT :== $BPA9::DISK24:[PSAP.IPF.CFPROGS]FASTOUT.EXE
> FASTOUT :== $BPA9::DISK24:[PSAP.IPF.CFPROGS]FASTOUT.ALF_EXE (for Alpha)
Typing the symbol name runs the program.
> FASTOUT

Follow the prompts.  Just press return to use the default values which are given
in brackets [].

IMPORTING FILE TO MICROSOFT EXCEL 5.0:

1.  Copy file from Vax to PC.  For example:
  > d:\decnet\nft copy BPA9::disk23:[wdr9936]norm.rpt
2.  Open report file with MS Excel.  The Text Import Wizard should come up.
3.  Text Import Wizard Step 1.  Choose the Delimited option.
4.  Text Import Wizard Step 2.  Set the Other Delimiter to vertical bar |.
5.  Text Import Wizard Step 3.  Use the General Column Data Format.  If the
    Rating Flag (F) columns are not desired, select these columns and set the 
    Do Not Import Columns (Skip) option.  Click Finish.
7.  Select entire document (highlight).
8.  Change document to a fixed-width, TrueType font such as MS LineDraw with 9 
    point size.
9.  Choose Format-Columns-AutoFit Selection from Menu.
10. For optimal alignment on Excel, use the following column widths:
    TY=3  OWNER=3  BRANCH NAMES=25  C=1  S=1  (UNIT)=7  ( %)=5  F=1 
11. Using the considerable power of Excel, format text any way desired.  Excel
    provides several ways to automate formatting and importing, such as Macros,
    Visual Application Basic, format paint brush, etc.

LOCATION: (Look here for the most recent updates.)
    BPA9::DISK24:[PSAP.IPF.CFPROGS]FASTOUT.EXE     - The VAX executable
    BPA9::DISK24:[PSAP.IPF.CFPROGS]FASTOUT.ALF_EXE - The ALPHA executable
    BPA9::DISK24:[PSAP.IPF.CFPROGS]FASTOUT.C       - The C source code
    BPA9::DISK24:[PSAP.IPF.CFDOC]FASTOUT.HELP      - Latest version of this file
